const seriesSimilares = [
  {
    titulo: "El Marginal",
    genero: "Crimen / Drama",
    actores: [
      {
        nombre: "Juan Minujín",
        wiki: "https://es.wikipedia.org/wiki/Juan_Minuj%C3%ADn",
      },
      {
        nombre: "Nicolás Furtado",
        wiki: "https://es.wikipedia.org/wiki/Nicol%C3%A1s_Furtado",
      },
      {
        nombre: "Claudio Rissi",
        wiki: "https://es.wikipedia.org/wiki/Claudio_Rissi",
      },
      {
        nombre: "Gerardo Romano",
        wiki: "https://es.wikipedia.org/wiki/Gerardo_Romano_(actor)",
      },
    ],
    descripcion:
      "Un expolicía se infiltra en una cárcel peligrosa para investigar un secuestro, enfrentando un entorno brutal.",
    imagen: "../assets/img/el_marginal_s.jpg",
    video: "https://www.youtube.com/embed/mN7xQF3hO1M",
    youtube: "https://www.youtube.com/watch?v=mN7xQF3hO1M&t=2s&pp=2AECkAIB",
    temporadas: [
      {
        numero: 1,
        capitulos: [
          { numero: 1, titulo: "Ingreso al infierno" },
          { numero: 2, titulo: "Reglas de la cárcel" },
        ],
      },
      {
        numero: 2,
        capitulos: [
          { numero: 1, titulo: "Nuevos enemigos" },
          { numero: 2, titulo: "Juego de poder" },
          { numero: 3, titulo: "El escape" },
        ],
      },
    ],
  },
  {
    titulo: "La Casa De Papel",
    genero: "Acción / Suspenso",
    actores: [
      {
        nombre: "Úrsula Corberó",
        wiki: "https://es.wikipedia.org/wiki/%C3%9Arsula_Corber%C3%B3",
      },
      {
        nombre: "Álvaro Morte",
        wiki: "https://es.wikipedia.org/wiki/%C3%81lvaro_Morte",
      },
      {
        nombre: "Itziar Ituño",
        wiki: "https://es.wikipedia.org/wiki/Itziar_Itu%C3%B1o",
      },
      {
        nombre: "Pedro Alonso",
        wiki: "https://es.wikipedia.org/wiki/Pedro_Alonso",
      },
      {
        nombre: "Miguel Herrán",
        wiki: "https://es.wikipedia.org/wiki/Miguel_Herr%C3%A1n",
      },
      {
        nombre: "Jaime Lorente",
        wiki: "https://es.wikipedia.org/wiki/Jaime_Lorente",
      },
      {
        nombre: "Alba Flores",
        wiki: "https://es.wikipedia.org/wiki/Alba_Flores",
      },
      {
        nombre: "Esther Acebo",
        wiki: "https://es.wikipedia.org/wiki/Esther_Acebo",
      },
    ],
    actores2: "Álvaro Morte, Úrsula Corberó, Pedro Alonso, Itziar Ituño",
    descripcion:
      "Un grupo de criminales ejecuta el mayor atraco de la historia bajo las órdenes del misterioso Profesor.",
    imagen: "../assets/img/la_casa_de_papel_s.jpg",
    video: "https://www.youtube.com/embed/3y-6iaveY6c",
    youtube: "https://www.youtube.com/watch?v=3y-6iaveY6c&t=2s&pp=2AECkAIB",
    temporadas: [
      {
        numero: 1,
        capitulos: [
          { numero: 1, titulo: "El plan comienza" },
          { numero: 2, titulo: "Rehenes y tensión" },
          { numero: 3, titulo: "Errores fatales" },
        ],
      },
      {
        numero: 2,
        capitulos: [
          { numero: 1, titulo: "Presión policial" },
          { numero: 2, titulo: "Todo o nada" },
        ],
      },
    ],
  },
  {
    titulo: "Adolescencia",
    genero: "Drama / Juvenil",
    actores: [
      {
        nombre: "Stephen Graham",
        wiki: "https://es.wikipedia.org/wiki/Stephen_Graham",
      },
      {
        nombre: "Owen Cooper",
        wiki: "https://es.wikipedia.org/wiki/Owen_Cooper",
      },
      {
        nombre: "Ashley Walters",
        wiki: "https://es.wikipedia.org/wiki/Ashley_Walters",
      },
      {
        nombre: "Erin Doherty",
        wiki: "https://es.wikipedia.org/wiki/Erin_Doherty",
      },
      {
        nombre: "Faye Marsay",
        wiki: "https://es.wikipedia.org/wiki/Faye_Marsay",
      },
    ],
    actores2: "Sofía Ramírez, Lucas Díaz, Camila Ortega",
    descripcion:
      "Un grupo de adolescentes atraviesa los desafíos del colegio, las relaciones y la búsqueda de identidad en una ciudad moderna.",
    imagen: "../assets/img/adolescencia_s.jpg",
    video: "https://www.youtube.com/embed/QFxl7FFv6lM",
    youtube: "https://www.youtube.com/watch?v=QFxl7FFv6lM&t=2s&pp=2AECkAIB",
    temporadas: [
      {
        numero: 1,
        capitulos: [
          { numero: 1, titulo: "Primer día" },
          { numero: 2, titulo: "Entre amigos y enemigos" },
          { numero: 3, titulo: "El secreto" },
        ],
      },
    ],
  },
  {
    titulo: "Café con Aroma de Mujer",
    genero: "Drama / Romance",
    actores: [
      {
        nombre: "William Levy",
        wiki: "https://es.wikipedia.org/wiki/William_Levy_(actor)",
      },
      {
        nombre: "Laura Londoño",
        wiki: "https://es.wikipedia.org/wiki/Laura_Londo%C3%B1o",
      },
      {
        nombre: "Carmen Villalobos",
        wiki: "https://es.wikipedia.org/wiki/Carmen_Villalobos",
      },
    ],
    actores2: "William Levy, Laura Londoño, Carmen Villalobos",
    descripcion:
      "La historia de amor entre Gaviota, una recolectora de café, y Sebastián, un joven de familia cafetera, llena de obstáculos y pasiones.",
    imagen: "../assets/img/cafe_con_aroma_de_mujer_s.jpg",
    video: "https://www.youtube.com/embed/ufs8NhLBuCk",
    youtube: "https://www.youtube.com/watch?v=ufs8NhLBuCk&t=2s&pp=2AECkAIB",
    temporadas: [
      {
        numero: 1,
        capitulos: [
          { numero: 1, titulo: "El encuentro" },
          { numero: 2, titulo: "Cosechas del corazón" },
          { numero: 3, titulo: "Mentiras entre granos" },
        ],
      },
    ],
  },
  {
    titulo: "Rosario Tijeras",
    genero: "Acción / Drama / Romance",
    actores: [
      {
        nombre: "Bárbara de Regil",
        wiki: "https://es.wikipedia.org/wiki/B%C3%A1rbara_de_Regil",
      },
      {
        nombre: "Sebastián Martínez",
        wiki: "https://es.wikipedia.org/wiki/Sebasti%C3%A1n_Mart%C3%ADnez_(actor)",
      },
      {
        nombre: "José María de Tavira",
        wiki: "https://es.wikipedia.org/wiki/Jos%C3%A9_Mar%C3%ADa_de_Tavira",
      },
      {
        nombre: "Antonio Gaona",
        wiki: "https://es.wikipedia.org/wiki/Antonio_Gaona",
      },
    ],
    actores2: "Bárbara de Regil, José María de Tavira, Antonio Gaona",
    descripcion:
      "Rosario, una joven de barrio humilde, se convierte en una mujer peligrosa en busca de justicia mientras lucha entre el amor y la venganza.",
    imagen: "../assets/img/rosario_tijeras_s.jpg",
    video: "https://www.youtube.com/embed/otZeqKDOXrg",
    youtube: "https://www.youtube.com/watch?v=otZeqKDOXrg&t=2s&pp=2AECkAIB",
    temporadas: [
      {
        numero: 1,
        capitulos: [
          { numero: 1, titulo: "Nacida en fuego" },
          { numero: 2, titulo: "La venganza comienza" },
        ],
      },
      {
        numero: 2,
        capitulos: [
          { numero: 1, titulo: "Pasado y presente" },
          { numero: 2, titulo: "Aliados inesperados" },
        ],
      },
    ],
  },
  {
    titulo: "El Eternauta",
    genero: "Ciencia ficción / Suspenso",
    actores: [
      {
        nombre: "Ricardo Darín",
        wiki: "https://es.wikipedia.org/wiki/Ricardo_Dar%C3%ADn",
      },
      {
        nombre: "Carla Peterson",
        wiki: "https://es.wikipedia.org/wiki/Carla_Peterson",
      },
      {
        nombre: "César Troncoso",
        wiki: "https://es.wikipedia.org/wiki/C%C3%A9sar_Troncoso",
      },
      {
        nombre: "Andrea Pietra",
        wiki: "https://es.wikipedia.org/wiki/Andrea_Pietra",
      },
    ],
    actores2: "Ricardo Darín, Dolores Fonzi, Peter Lanzani",
    descripcion:
      "Una nevada mortal azota Buenos Aires y un grupo de sobrevivientes debe enfrentarse a una invasión alienígena mientras luchan por mantenerse con vida.",
    imagen: "../assets/img/eternauta_s.jpg",
    video: "https://www.youtube.com/embed/ykLTd5aTa88",
    youtube: "https://www.youtube.com/watch?v=ykLTd5aTa88&t=2s&pp=2AECkAIB",
    temporadas: [
      {
        numero: 1,
        capitulos: [
          { numero: 1, titulo: "La nevada" },
          { numero: 2, titulo: "Sobrevivientes" },
          { numero: 3, titulo: "El enemigo invisible" },
        ],
      },
    ],
  },
];

function addDefault(serieDefault) {
  document.getElementById("titulo").textContent = serieDefault.titulo;
  document.getElementById("genero").textContent = serieDefault.genero;
  document.getElementById("actores").textContent = serieDefault.actores;
  document.getElementById("descripcion").textContent = serieDefault.descripcion;
  document.getElementById("trailer").src = serieDefault.video;
  document.getElementById("comenzar").href = serieDefault.youtube;
}

function addImage(serieDefault) {
  const carrusel = document.getElementById("similaresCarrusel");
  carrusel.innerHTML = ""; // Limpiar contenido anterior

  document.getElementById("capitulos").innerHTML =
    '<option value="">Seleccionar capítulo</option>';

  seriesSimilares
    .filter((serie) => serie.titulo !== serieDefault.titulo)
    .forEach((serie) => {
      const img = document.createElement("img");
      img.src = serie.imagen;
      img.alt = serie.titulo;
      img.classList.add("imagenes");
      carrusel.appendChild(img);
    });
}

function addActors(serieDefault) {
  const actoresContainer = document.getElementById("actores");
  actoresContainer.innerHTML = ""; // limpio contenido previo

  serieDefault.actores.forEach((actor, index) => {
    const a = document.createElement("a");
    a.href = actor.wiki;
    a.target = "_blank";
    a.textContent = actor.nombre;
    actoresContainer.appendChild(a);

    // Agrego coma y espacio excepto después del último actor
    if (index < serieDefault.actores.length - 1) {
      actoresContainer.appendChild(document.createTextNode(", "));
    }
  });
}

function addVideo(video) {
  const btn = document.getElementById("comenzar");
  btn.onclick = () => {
    window.open(video, "_blank"); // Abre en nueva pestaña
  };
}

function addTemp(serieDefault) {
  const selectTemporadas = document.getElementById("temporadas");
  selectTemporadas.innerHTML =
    '<option value="">Seleccionar temporada</option>';

  serieDefault.temporadas.forEach((temp, index) => {
    const option = document.createElement("option");
    option.value = index;
    option.textContent = `Temporada ${temp.numero}`;
    selectTemporadas.appendChild(option);
    document.getElementById("capitulos").innerHTML =
      '<option value="">Seleccionar capítulo</option>';
  });
}

let serie = null;

function carruselMove() {
  const carrusel = document.getElementById("similaresCarrusel");
  const prev = document.querySelector(".carrusel-btn.prev");
  const next = document.querySelector(".carrusel-btn.next");
  const img = carrusel.querySelector(".imagenes");
  const scroll = img ? img.offsetWidth + 10 : 0;

  prev.addEventListener("click", () => {
    carrusel.scrollBy({ left: -scroll, behavior: "smooth" });
  });

  next.addEventListener("click", () => {
    carrusel.scrollBy({ left: scroll, behavior: "smooth" });
  });
}

function selectorTemporadas() {
  const selector = document.getElementById("temporadas");

  selector.addEventListener("change", function () {
    const temporadaIndex = this.value;
    const capitulosSelect = document.getElementById("capitulos");
    capitulosSelect.innerHTML =
      '<option value="">Seleccionar capítulo</option>';

    if (serie && temporadaIndex !== "") {
      const temporada = serie.temporadas[temporadaIndex];
      temporada.capitulos.forEach((cap, index) => {
        const opt = document.createElement("option");
        opt.value = index;
        opt.textContent = cap.titulo;
        capitulosSelect.appendChild(opt);
      });
    }
  });
}

function asignarEventosCarruselSeries() {
  const imagenes = document.querySelectorAll(".imagenes");
  imagenes.forEach((img) => {
    img.addEventListener("click", () => {
      serie = seriesSimilares.find((imagen) => imagen.titulo == img.alt);
      addDefault(serie);
      addTemp(serie);
      addActors(serie);
      addVideo(serie.video);
      addImage(serie); // Regeneramos imágenes
      asignarEventosCarruselSeries(); // Vuelve a asignar eventos a las nuevas imágenes
    });
  });
}

document.addEventListener("DOMContentLoaded", () => {

  const params = new URLSearchParams(window.location.search);
  const titulo = params?.get("titulo");
  console.log(titulo)
  serie = seriesSimilares.find(a=> a.titulo == titulo) ?? seriesSimilares[0];

  addDefault(serie);
  addTemp(serie);
  addVideo(serie.video);
  addImage(serie);
  addActors(serie);

  carruselMove();
  asignarEventosCarruselSeries();
  selectorTemporadas();
});
